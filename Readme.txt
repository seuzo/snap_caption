ソフト名：snap_caption.jsx（0.9）
ライセンス：GNU GPLv3
転載条件：メールにて確認
　　作者：市川せうぞー／(c)2007-2009 Seuzo Ichikawa
動作環境：MacOS X10.5.6、InDesign CS4_J（6.0.1）
開発環境：Mac Pro Quad 3GHz（Intel）、ExtendScript Toolkit
開発言語：JavaScript
圧縮方法：zip
コメント：

**何をするスクリプトか？
画像に対してキャプションを任意のアキでスナップさせます。
簡単な使い方説明：http://jp.youtube.com/watch?v=a8ar4Ydq0ww


**同梱ファイル2Files
-Readme.txt	このファイルです。とにかく最初によんでください。
-snap_caption.jsx	スクリプト本体です。


**使用条件
このスクリプトが正常に動作する環境は以下の通りです。Windows環境でも動作する可能性がありますが未検証です。
-MacOS X10.5.6
-InDesign CS4_J（6.0.1）
#InDesign CS3_J（5.0.2）、InDesign CS2_J（4.0.5）でも動作するかもしれません。


**ダウンロード
[http://www.seuzo.jp/st/scripts_InDesignCS4/index.html#snap_caption]
gitをお使いの方はこちら：
[http://github.com/seuzo/snap_caption/]


**インストール
スクリプト本体（snap_caption.jsx）を
~/Library/Preferences/Adobe InDesign/Version 6.0-J/ja_JP/Scripts/Scripts Panel/
にコピーしてください。エイリアスを入れておくだけでもかまいません。
スクリプトパレットから使用します。


**使用方法
+「ウインドウ」メニューから「スクリプティング」ー「スクリプト」を選択し、スクリプトパレットを出します。
+選択ツールで画像とテキストフレーム（キャプション）を選択します。
+スクリプトパレットから、スクリプト「snap_caption.jsx」をダブルクリックします。ショートカットを割り当てておくとさらに便利。


**設定
画像とキャプションの間隔は、スクリプト本体（snap_caption.jsx）を直接エディタなどで開いて
	const my_distance = 1; //画像とキャプションの間隔（単位は環境設定に依存）
の部分を書き換えてください。
他のオプションについても同様に再編集してください。オプションの説明文は便宜上、横組キャプションの時を想定しています。


**テキストフレームの位置判定について。
横組キャプションの位置判定は、次の順序で行っています。縦組のキャプションの場合は、それぞれ90度回転させた形で考えてください。
+テキストフレームのY1座標がグラフィックフレームのY2座標より下なら、すべて下付きのキャプション
+テキストフレームのY2座標がグラフィックフレームのY1座標より上なら、すべて上付きのキャプション
+テキストフレームのX2座標が画像フレームのX2座標より右なら、右付きのキャプション
+テキストフレームのX1座標が画像フレームのX1座標より左なら、左付きのキャプション
+２または３の時、テキストフレームの中心がグラフィックフレームの中心より下にあるなら、それぞれの下にそろえます。


**既知の不具合、またはToDo
対象オブジェクトが回転している場合、正しく処理しません。
画像内にクリッピングパスを持っていたらスナップさせたい、かも。


**免責事項
-本アプリケーションはInDesignにおける作業効率支援なのであって、処理結果を保証するものではありません。かならず確認をされることをおすすめします。
-このツールを使用する上でデータの破損などのあらゆる不具合・不利益については一切の責任を負いかねますのでご了解ください。
-このツールはすべてのMacintoshとMac OS上で動作をするという確認をとっていませんし、事実上出来ません。したがって、動作を保証するものではありません。


**ライセンス
GNU GPLv3
http://sourceforge.jp/projects/opensource/wiki/licenses%252FGNU_General_Public_License_version_3.0


**履　歴
2007-12-16	ver.0.1	とりあえず横組キャプションしか考えてません。
2007-12-17	ver.0.2	「設定」にmy_text_align_topを追加
2007-12-18	ver.0.3	画像がグループ化されていても動作するようにした。グラフィックフレームが楕円または多角形でも動作するようにした。「設定」にmy_text_fitを追加。テキストフレームの上辺がグラフィックフレームの底辺のわずかに（my_distance値の２倍分）上にあっても、下揃えのキャプションと判定することにした。
2007-12-19	ver.0.4	my_text_fitをテキストフレームがオーバーセットしている時のみ動作するようにした。
2007-12-21	ver.0.5	上付きキャプションに対応した。全体的にコードの整理、、、整理したはずなのに、だんだんジャミってkt..
2007-12-23	ver.0.6	クリスマス前で暇なので、コードの生理。血だらけ。
2007-12-24	ver.0.7	いぜんとして暇なので（クライアントさまはクリスマスイブをエンジョイしてるようだ）、縦組キャプションにも対応した。クリスマスを撃ち殺せバージョン（そしてやはり血だらけ）。
2008-03-16	ver.0.8	ページルーラーの開始位置が「スプレッド」以外になっていたら、「スプレッド」に一時的に変更するようにした。オブジェクトがロックされている時、エラーにするようにした。グループ中のひとつが選択されている時、エラーになるようにした。
2009-04-18	ver.0.9	InDesign CS4対応。スプレッドが回転表示しているときは、スクリプトの実行を中止するようにした。


市川せうぞー
http://www.seuzo.jp/
